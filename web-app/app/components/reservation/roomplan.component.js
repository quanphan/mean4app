System.register(['@angular/core', '../../services/auth.service', '../../services/common.service', '@angular/router', '../../components/commonfs'], function(exports_1, context_1) {
    "use strict";
    var __moduleName = context_1 && context_1.id;
    var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
        if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        return c > 3 && r && Object.defineProperty(target, key, r), r;
    };
    var __metadata = (this && this.__metadata) || function (k, v) {
        if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
    };
    var core_1, auth_service_1, common_service_1, router_1, commonfs_1;
    var RoomplanComponent;
    return {
        setters:[
            function (core_1_1) {
                core_1 = core_1_1;
            },
            function (auth_service_1_1) {
                auth_service_1 = auth_service_1_1;
            },
            function (common_service_1_1) {
                common_service_1 = common_service_1_1;
            },
            function (router_1_1) {
                router_1 = router_1_1;
            },
            function (commonfs_1_1) {
                commonfs_1 = commonfs_1_1;
            }],
        execute: function() {
            let RoomplanComponent = class RoomplanComponent {
                constructor(router, authService, commonService, datetime, elRef) {
                    this.router = router;
                    this.authService = authService;
                    this.commonService = commonService;
                    this.datetime = datetime;
                    this.elRef = elRef;
                    this.dayView = 15;
                    this.dates = [];
                    this.yearMonth = [];
                    this.res = { RoomNo: '201', RoomType: 'Superior Room', CompanyID: '' };
                    this.rooms = [
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '101' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '102' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '103' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '104' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '105' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '106' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '107' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '201' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '202' },
                        { Type: 'SUP', TypeName: 'Del', RoomNo: '203' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '204' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '205' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '206' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '207' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '301' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '302' },
                        { Type: 'SUP', TypeName: 'Sta', RoomNo: '303' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '304' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '305' },
                        { Type: 'SUP', TypeName: 'Del', RoomNo: '401' },
                        { Type: 'SUP', TypeName: 'Sup', RoomNo: '402' },
                        { Type: 'SUP', TypeName: 'Del', RoomNo: '403' },
                    ];
                    this.resSelect = { ID: '', RoomNo: '', FromDate: '', ToDate: '', tempID: '', selected: false };
                    this.resData = [
                        { ResID: '1', RoomNo: '102', FromDate: '8', ToDate: '11', Status: '3' },
                        { ResID: '2', RoomNo: '105', FromDate: '9', ToDate: '14', Status: '1' },
                        { ResID: '3', RoomNo: '203', FromDate: '11', ToDate: '16', Status: '1' },
                        { ResID: '4', RoomNo: '301', FromDate: '8', ToDate: '12', Status: '3' },
                        { ResID: '5', RoomNo: '201', FromDate: '14', ToDate: '15', Status: '1' },
                    ];
                    this._res = { ResID: '', RoomNo: '', FromDate: '', ToDate: '', Status: '' };
                    this.authService.setPageTitle('Room plans');
                    this.getDate(this.dayView);
                }
                getDate(days) {
                    let curDate = this.datetime.getCurDate();
                    let Ds = 0;
                    let MY;
                    for (var _i = -1; _i <= days; _i++) {
                        let _date = this.datetime.addDate(curDate, _i);
                        let _my = this.datetime.getYearMonth(_date);
                        let _month = this.datetime.getMonth(_date);
                        let _year = this.datetime.getYear(_date);
                        let _day = this.datetime.getDate(_date);
                        this.dates.push({ day: _day, month: _month, year: _year });
                        Ds++;
                        if (_i == -1) {
                            MY = _my;
                            this.yearMonth.push({ days: Ds, month: MY });
                            this.yesterday = _day;
                        }
                        else {
                            if (MY != _my) {
                                MY = _my;
                                this.yearMonth.push({ days: Ds, month: MY });
                                Ds = 1;
                            }
                            else {
                                for (var k = 0; k <= this.yearMonth.length; k++) {
                                    if (this.yearMonth[k].month == _my) {
                                        this.yearMonth[k].days = Ds;
                                        break;
                                    }
                                }
                            }
                        }
                    }
                }
                IsSelectRoom(room, date) {
                    if (room == this.resSelect.RoomNo &&
                        parseInt(date.day) >= parseInt(this.resSelect.FromDate) && parseInt(date.day) <= parseInt(this.resSelect.ToDate)) {
                        return true;
                    }
                    return false;
                }
                CheckStatusRoom(room, date, status) {
                    let _tempRes = this.CheckRes(room, date);
                    if (_tempRes != null) {
                        if (_tempRes.Status == status)
                            return true;
                    }
                    return false;
                }
                resSelected() {
                    this.resSelect.selected = true;
                }
                resItem(room, date) {
                    let _tempRes = this.CheckRes(room, date);
                    if (_tempRes != null) {
                        this.resSelect.ID = _tempRes.ResID;
                        this.resSelect.RoomNo = _tempRes.RoomNo;
                        this.resSelect.FromDate = _tempRes.FromDate;
                        this.resSelect.ToDate = _tempRes.ToDate;
                        this.resSelect.selected = true;
                    }
                }
                setResUI(room, date) {
                    if (room == this.resSelect.RoomNo && this.resSelect.selected) {
                        if (parseInt(date.day) == parseInt(this.resSelect.FromDate)) {
                            let night = parseInt(this.resSelect.ToDate) - parseInt(this.resSelect.FromDate);
                            return night + 1;
                        }
                    }
                    let _tempRes = this.CheckRes(room, date);
                    if (_tempRes != null) {
                        let night = parseInt(_tempRes.ToDate) - parseInt(_tempRes.FromDate);
                        return night + 1;
                    }
                    return 1;
                }
                checkDateUISelect(room, date) {
                    if (room == this.resSelect.RoomNo && this.resSelect.selected) {
                        if (parseInt(date.day) > parseInt(this.resSelect.FromDate) && parseInt(date.day) <= parseInt(this.resSelect.ToDate)) {
                            return false;
                        }
                    }
                    let _tempRes = this.CheckRes(room, date);
                    if (_tempRes != null) {
                        if (parseInt(date.day) > parseInt(_tempRes.FromDate) && parseInt(date.day) <= parseInt(_tempRes.ToDate)) {
                            return false;
                        }
                    }
                    return true;
                }
                GetRes(room, date) {
                    let res = this._res;
                    let _tempRes = this.CheckRes(room, date);
                    if (_tempRes != null) {
                        return _tempRes;
                    }
                    if (room == this.resSelect.RoomNo && parseInt(date.day) == parseInt(this.resSelect.FromDate) && this.resSelect.selected) {
                        return this.resSelect;
                    }
                    return res;
                }
                CheckRes(room, date) {
                    for (var k = 0; k < this.resData.length; k++) {
                        if (this.resData[k].RoomNo == room && parseInt(date.day) == parseInt(this.resData[k].FromDate)) {
                            return this.resData[k];
                        }
                    }
                    return null;
                }
            };
            RoomplanComponent = __decorate([
                core_1.Component({
                    templateUrl: '/views/reservation/roomplan.html',
                    providers: [common_service_1.CommonService, commonfs_1.Datetime],
                }), 
                __metadata('design:paramtypes', [router_1.Router, auth_service_1.AuthService, common_service_1.CommonService, commonfs_1.Datetime, core_1.ElementRef])
            ], RoomplanComponent);
            exports_1("RoomplanComponent", RoomplanComponent);
        }
    }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvcmVzZXJ2YXRpb24vcm9vbXBsYW4uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1lBaUJBO2dCQUtJLFlBQW9CLE1BQWEsRUFDYixXQUF1QixFQUN2QixhQUEyQixFQUM1QixRQUFpQixFQUNoQixLQUFnQjtvQkFKaEIsV0FBTSxHQUFOLE1BQU0sQ0FBTztvQkFDYixnQkFBVyxHQUFYLFdBQVcsQ0FBWTtvQkFDdkIsa0JBQWEsR0FBYixhQUFhLENBQWM7b0JBQzVCLGFBQVEsR0FBUixRQUFRLENBQVM7b0JBQ2hCLFVBQUssR0FBTCxLQUFLLENBQVc7b0JBUjdCLFlBQU8sR0FBQyxFQUFFLENBQUM7b0JBQ2xCLFVBQUssR0FBSyxFQUFFLENBQUM7b0JBQ2IsY0FBUyxHQUFLLEVBQUUsQ0FBQztvQkFZakIsUUFBRyxHQUFDLEVBQUMsTUFBTSxFQUFDLEtBQUssRUFBQyxRQUFRLEVBQUMsZUFBZSxFQUFDLFNBQVMsRUFBQyxFQUFFLEVBQUMsQ0FBQztvQkEwQ3pELFVBQUssR0FBQzt3QkFDRixFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3dCQUN4QyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDO3FCQUMzQyxDQUFBO29CQUVELGNBQVMsR0FBQyxFQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsTUFBTSxFQUFDLEVBQUUsRUFBQyxRQUFRLEVBQUMsRUFBRSxFQUFDLE1BQU0sRUFBQyxFQUFFLEVBQUMsTUFBTSxFQUFDLEVBQUUsRUFBQyxRQUFRLEVBQUMsS0FBSyxFQUFDLENBQUE7b0JBQzFFLFlBQU8sR0FBQzt3QkFDSixFQUFDLEtBQUssRUFBQyxHQUFHLEVBQUMsTUFBTSxFQUFDLEtBQUssRUFBQyxRQUFRLEVBQUMsR0FBRyxFQUFFLE1BQU0sRUFBQyxJQUFJLEVBQUMsTUFBTSxFQUFDLEdBQUcsRUFBQzt3QkFDN0QsRUFBQyxLQUFLLEVBQUMsR0FBRyxFQUFDLE1BQU0sRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUMsSUFBSSxFQUFDLE1BQU0sRUFBQyxHQUFHLEVBQUM7d0JBQzdELEVBQUMsS0FBSyxFQUFDLEdBQUcsRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDLFFBQVEsRUFBQyxJQUFJLEVBQUUsTUFBTSxFQUFDLElBQUksRUFBQyxNQUFNLEVBQUMsR0FBRyxFQUFDO3dCQUM5RCxFQUFDLEtBQUssRUFBQyxHQUFHLEVBQUMsTUFBTSxFQUFDLEtBQUssRUFBQyxRQUFRLEVBQUMsR0FBRyxFQUFFLE1BQU0sRUFBQyxJQUFJLEVBQUMsTUFBTSxFQUFDLEdBQUcsRUFBQzt3QkFDN0QsRUFBQyxLQUFLLEVBQUMsR0FBRyxFQUFDLE1BQU0sRUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLElBQUksRUFBRSxNQUFNLEVBQUMsSUFBSSxFQUFDLE1BQU0sRUFBQyxHQUFHLEVBQUM7cUJBQ2pFLENBQUE7b0JBQ0QsU0FBSSxHQUFDLEVBQUMsS0FBSyxFQUFDLEVBQUUsRUFBQyxNQUFNLEVBQUMsRUFBRSxFQUFDLFFBQVEsRUFBQyxFQUFFLEVBQUUsTUFBTSxFQUFDLEVBQUUsRUFBQyxNQUFNLEVBQUMsRUFBRSxFQUFDLENBQUM7b0JBL0V2RCxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQztvQkFDNUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQy9CLENBQUM7Z0JBSUQsT0FBTyxDQUFDLElBQUk7b0JBRVIsSUFBSSxPQUFPLEdBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQztvQkFDdkMsSUFBSSxFQUFFLEdBQVEsQ0FBQyxDQUFDO29CQUNoQixJQUFJLEVBQUUsQ0FBQztvQkFDUCxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLElBQUksSUFBSSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7d0JBQ2pDLElBQUksS0FBSyxHQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBQyxFQUFFLENBQUMsQ0FBQzt3QkFDNUMsSUFBSSxHQUFHLEdBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQzFDLElBQUksTUFBTSxHQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO3dCQUN6QyxJQUFJLEtBQUssR0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQzt3QkFDdkMsSUFBSSxJQUFJLEdBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQ3RDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUMsR0FBRyxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsTUFBTSxFQUFDLElBQUksRUFBQyxLQUFLLEVBQUMsQ0FBQyxDQUFDO3dCQUVwRCxFQUFFLEVBQUUsQ0FBQzt3QkFDTCxFQUFFLENBQUEsQ0FBQyxFQUFFLElBQUUsQ0FBQyxDQUFDLENBQUMsQ0FDVixDQUFDOzRCQUNHLEVBQUUsR0FBQyxHQUFHLENBQUM7NEJBQ1AsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBQyxJQUFJLEVBQUMsRUFBRSxFQUFDLEtBQUssRUFBQyxFQUFFLEVBQUMsQ0FBQyxDQUFDOzRCQUN4QyxJQUFJLENBQUMsU0FBUyxHQUFDLElBQUksQ0FBQzt3QkFDeEIsQ0FBQzt3QkFDRCxJQUFJLENBQUMsQ0FBQzs0QkFDRixFQUFFLENBQUEsQ0FBQyxFQUFFLElBQUUsR0FBRyxDQUFDLENBQUEsQ0FBQztnQ0FDUixFQUFFLEdBQUMsR0FBRyxDQUFDO2dDQUNQLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUMsSUFBSSxFQUFDLEVBQUUsRUFBQyxLQUFLLEVBQUMsRUFBRSxFQUFDLENBQUMsQ0FBQztnQ0FDeEMsRUFBRSxHQUFDLENBQUMsQ0FBQzs0QkFDVCxDQUFDOzRCQUNELElBQUksQ0FBQyxDQUFDO2dDQUNGLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBQyxDQUFDLElBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQztvQ0FDekMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQzt3Q0FDakMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO3dDQUM1QixLQUFLLENBQUM7b0NBQ1YsQ0FBQztnQ0FDTCxDQUFDOzRCQUNMLENBQUM7d0JBQ0wsQ0FBQztvQkFFTCxDQUFDO2dCQUVMLENBQUM7Z0JBcUNELFlBQVksQ0FBQyxJQUFJLEVBQUMsSUFBSTtvQkFFbEIsRUFBRSxDQUFBLENBQUMsSUFBSSxJQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTTt3QkFDMUIsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUEsQ0FBQzt3QkFDaEgsTUFBTSxDQUFDLElBQUksQ0FBQTtvQkFDZixDQUFDO29CQUNELE1BQU0sQ0FBQyxLQUFLLENBQUM7Z0JBQ2pCLENBQUM7Z0JBRUQsZUFBZSxDQUFDLElBQUksRUFBQyxJQUFJLEVBQUMsTUFBTTtvQkFFNUIsSUFBSSxRQUFRLEdBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ3RDLEVBQUUsQ0FBQSxDQUFDLFFBQVEsSUFBRSxJQUFLLENBQUMsQ0FDbkIsQ0FBQzt3QkFDRSxFQUFFLENBQUEsQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFFLE1BQU0sQ0FBQzs0QkFDM0IsTUFBTSxDQUFDLElBQUksQ0FBQztvQkFDZixDQUFDO29CQUNELE1BQU0sQ0FBQyxLQUFLLENBQUM7Z0JBQ2pCLENBQUM7Z0JBRUQsV0FBVztvQkFFUCxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsR0FBQyxJQUFJLENBQUM7Z0JBQ2pDLENBQUM7Z0JBRUQsT0FBTyxDQUFDLElBQUksRUFBQyxJQUFJO29CQUViLElBQUksUUFBUSxHQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFDLElBQUksQ0FBQyxDQUFDO29CQUN0QyxFQUFFLENBQUEsQ0FBQyxRQUFRLElBQUUsSUFBSyxDQUFDLENBQ25CLENBQUM7d0JBQ0csSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQzt3QkFDakMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQzt3QkFDdEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQzt3QkFDMUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQzt3QkFDdEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUMsSUFBSSxDQUFDO29CQUNqQyxDQUFDO2dCQUNMLENBQUM7Z0JBRUQsUUFBUSxDQUFDLElBQUksRUFBQyxJQUFJO29CQUVkLEVBQUUsQ0FBQSxDQUFDLElBQUksSUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVMsQ0FBQyxDQUFBLENBQUM7d0JBQ3hELEVBQUUsQ0FBQSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FDMUQsQ0FBQzs0QkFDRyxJQUFJLEtBQUssR0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQzs0QkFDNUUsTUFBTSxDQUFDLEtBQUssR0FBQyxDQUFDLENBQUM7d0JBQ25CLENBQUM7b0JBQ0wsQ0FBQztvQkFFRCxJQUFJLFFBQVEsR0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBQyxJQUFJLENBQUMsQ0FBQztvQkFDdEMsRUFBRSxDQUFBLENBQUMsUUFBUSxJQUFFLElBQUssQ0FBQyxDQUNuQixDQUFDO3dCQUNHLElBQUksS0FBSyxHQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQzt3QkFDaEUsTUFBTSxDQUFDLEtBQUssR0FBQyxDQUFDLENBQUM7b0JBQ25CLENBQUM7b0JBRUQsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFDYixDQUFDO2dCQUVELGlCQUFpQixDQUFDLElBQUksRUFBQyxJQUFJO29CQUV2QixFQUFFLENBQUEsQ0FBQyxJQUFJLElBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFTLENBQUMsQ0FBQSxDQUFDO3dCQUN4RCxFQUFFLENBQUEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFFLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FDakgsQ0FBQzs0QkFDRyxNQUFNLENBQUMsS0FBSyxDQUFDO3dCQUNqQixDQUFDO29CQUNMLENBQUM7b0JBRUQsSUFBSSxRQUFRLEdBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ3RDLEVBQUUsQ0FBQSxDQUFDLFFBQVEsSUFBRSxJQUFLLENBQUMsQ0FDbkIsQ0FBQzt3QkFDRyxFQUFFLENBQUEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBRyxRQUFRLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQzs0QkFDbkcsTUFBTSxDQUFDLEtBQUssQ0FBQzt3QkFDakIsQ0FBQztvQkFDTCxDQUFDO29CQUVELE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ2hCLENBQUM7Z0JBR0QsTUFBTSxDQUFDLElBQUksRUFBQyxJQUFJO29CQUVaLElBQUksR0FBRyxHQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7b0JBQ2xCLElBQUksUUFBUSxHQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFDLElBQUksQ0FBQyxDQUFDO29CQUV0QyxFQUFFLENBQUEsQ0FBQyxRQUFRLElBQUUsSUFBSSxDQUFDLENBQ2xCLENBQUM7d0JBQ0csTUFBTSxDQUFDLFFBQVEsQ0FBQztvQkFDcEIsQ0FBQztvQkFFRCxFQUFFLENBQUEsQ0FBQyxJQUFJLElBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFBLENBQUM7d0JBQ2pILE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO29CQUMxQixDQUFDO29CQUVELE1BQU0sQ0FBQyxHQUFHLENBQUM7Z0JBQ2YsQ0FBQztnQkFFRCxRQUFRLENBQUMsSUFBSSxFQUFDLElBQUk7b0JBRWQsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFDLENBQUMsR0FBRSxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO3dCQUN0QyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sSUFBSSxJQUFJLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBRyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQzVGLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUMzQixDQUFDO29CQUNMLENBQUM7b0JBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQztnQkFDaEIsQ0FBQztZQUVMLENBQUM7WUEzTUQ7Z0JBQUMsZ0JBQVMsQ0FBQztvQkFDUCxXQUFXLEVBQUMsa0NBQWtDO29CQUM5QyxTQUFTLEVBQUUsQ0FBQyw4QkFBYSxFQUFDLG1CQUFRLENBQUM7aUJBQ3RDLENBQUM7O2lDQUFBO1lBRUYsaURBc01DLENBQUEiLCJmaWxlIjoiY29tcG9uZW50cy9yZXNlcnZhdGlvbi9yb29tcGxhbi5jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgcGhhbnF1YW4gb24gNS8xNC8xNi5cbiAqL1xuaW1wb3J0IHtDb21wb25lbnQsRWxlbWVudFJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0NoZWNraW5Db21wb25lbnR9IGZyb20gXCJjb21wb25lbnRzL3Jlc2VydmF0aW9uL2NoZWNraW4uY29tcG9uZW50XCI7XG5pbXBvcnQge0F1dGhTZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UnO1xuaW1wb3J0IHtDb21tb25TZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jb21tb24uc2VydmljZSc7XG5pbXBvcnQge1JvdXRlcn0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcblxuaW1wb3J0IHtEYXRldGltZSx9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvY29tbW9uZnMnO1xuXG5kZWNsYXJlIHZhciBqUXVlcnk6YW55O1xuQENvbXBvbmVudCh7XG4gICAgdGVtcGxhdGVVcmw6Jy92aWV3cy9yZXNlcnZhdGlvbi9yb29tcGxhbi5odG1sJyxcbiAgICBwcm92aWRlcnM6IFtDb21tb25TZXJ2aWNlLERhdGV0aW1lXSxcbn0pXG5cbmV4cG9ydCBjbGFzcyBSb29tcGxhbkNvbXBvbmVudCB7XG4gICAgcHVibGljIGRheVZpZXc9MTU7XG4gICAgZGF0ZXM6YW55PVtdO1xuICAgIHllYXJNb250aDphbnk9W107XG4gICAgeWVzdGVyZGF5OmFueTtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvdXRlcjpSb3V0ZXIsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBhdXRoU2VydmljZTpBdXRoU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGNvbW1vblNlcnZpY2U6Q29tbW9uU2VydmljZSxcbiAgICAgICAgICAgICAgICBwdWJsaWMgZGF0ZXRpbWU6RGF0ZXRpbWUsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBlbFJlZjpFbGVtZW50UmVmXG4gICAgKSB7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2Uuc2V0UGFnZVRpdGxlKCdSb29tIHBsYW5zJyk7XG4gICAgICAgIHRoaXMuZ2V0RGF0ZSh0aGlzLmRheVZpZXcpO1xuICAgIH1cblxuICAgIHJlcz17Um9vbU5vOicyMDEnLFJvb21UeXBlOidTdXBlcmlvciBSb29tJyxDb21wYW55SUQ6Jyd9O1xuXG4gICAgZ2V0RGF0ZShkYXlzKVxuICAgIHtcbiAgICAgICAgbGV0IGN1ckRhdGU9dGhpcy5kYXRldGltZS5nZXRDdXJEYXRlKCk7XG4gICAgICAgIGxldCBEczpudW1iZXI9MDtcbiAgICAgICAgbGV0IE1ZO1xuICAgICAgICBmb3IgKHZhciBfaSA9IC0xOyBfaSA8PSBkYXlzOyBfaSsrKSB7XG4gICAgICAgICAgICBsZXQgX2RhdGU9dGhpcy5kYXRldGltZS5hZGREYXRlKGN1ckRhdGUsX2kpO1xuICAgICAgICAgICAgbGV0IF9teT10aGlzLmRhdGV0aW1lLmdldFllYXJNb250aChfZGF0ZSk7XG4gICAgICAgICAgICBsZXQgX21vbnRoPXRoaXMuZGF0ZXRpbWUuZ2V0TW9udGgoX2RhdGUpO1xuICAgICAgICAgICAgbGV0IF95ZWFyPXRoaXMuZGF0ZXRpbWUuZ2V0WWVhcihfZGF0ZSk7XG4gICAgICAgICAgICBsZXQgX2RheT10aGlzLmRhdGV0aW1lLmdldERhdGUoX2RhdGUpO1xuICAgICAgICAgICAgdGhpcy5kYXRlcy5wdXNoKHtkYXk6X2RheSxtb250aDpfbW9udGgseWVhcjpfeWVhcn0pO1xuXG4gICAgICAgICAgICBEcysrO1xuICAgICAgICAgICAgaWYoX2k9PS0xKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIE1ZPV9teTtcbiAgICAgICAgICAgICAgICB0aGlzLnllYXJNb250aC5wdXNoKHtkYXlzOkRzLG1vbnRoOk1ZfSk7XG4gICAgICAgICAgICAgICAgdGhpcy55ZXN0ZXJkYXk9X2RheTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmKE1ZIT1fbXkpe1xuICAgICAgICAgICAgICAgICAgICBNWT1fbXk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMueWVhck1vbnRoLnB1c2goe2RheXM6RHMsbW9udGg6TVl9KTtcbiAgICAgICAgICAgICAgICAgICAgRHM9MTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGs9MDtrPD0gdGhpcy55ZWFyTW9udGgubGVuZ3RoO2srKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMueWVhck1vbnRoW2tdLm1vbnRoID09IF9teSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueWVhck1vbnRoW2tdLmRheXMgPSBEcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICByb29tcz1bXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTAxJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTAyJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTAzJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTA0J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTA1J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTA2J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMTA3J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMjAxJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMjAyJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidEZWwnLFJvb21ObzonMjAzJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMjA0J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMjA1J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMjA2J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMjA3J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMzAxJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMzAyJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdGEnLFJvb21ObzonMzAzJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMzA0J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonMzA1J30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidEZWwnLFJvb21ObzonNDAxJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidTdXAnLFJvb21ObzonNDAyJ30sXG4gICAgICAgIHtUeXBlOidTVVAnLFR5cGVOYW1lOidEZWwnLFJvb21ObzonNDAzJ30sXG4gICAgXVxuXG4gICAgcmVzU2VsZWN0PXtJRDonJyxSb29tTm86JycsRnJvbURhdGU6JycsVG9EYXRlOicnLHRlbXBJRDonJyxzZWxlY3RlZDpmYWxzZX1cbiAgICByZXNEYXRhPVtcbiAgICAgICAge1Jlc0lEOicxJyxSb29tTm86JzEwMicsRnJvbURhdGU6JzgnLCBUb0RhdGU6JzExJyxTdGF0dXM6JzMnfSxcbiAgICAgICAge1Jlc0lEOicyJyxSb29tTm86JzEwNScsRnJvbURhdGU6JzknLCBUb0RhdGU6JzE0JyxTdGF0dXM6JzEnfSxcbiAgICAgICAge1Jlc0lEOiczJyxSb29tTm86JzIwMycsRnJvbURhdGU6JzExJywgVG9EYXRlOicxNicsU3RhdHVzOicxJ30sXG4gICAgICAgIHtSZXNJRDonNCcsUm9vbU5vOiczMDEnLEZyb21EYXRlOic4JywgVG9EYXRlOicxMicsU3RhdHVzOiczJ30sXG4gICAgICAgIHtSZXNJRDonNScsUm9vbU5vOicyMDEnLEZyb21EYXRlOicxNCcsIFRvRGF0ZTonMTUnLFN0YXR1czonMSd9LFxuICAgIF1cbiAgICBfcmVzPXtSZXNJRDonJyxSb29tTm86JycsRnJvbURhdGU6JycsIFRvRGF0ZTonJyxTdGF0dXM6Jyd9O1xuXG4gICAgSXNTZWxlY3RSb29tKHJvb20sZGF0ZSlcbiAgICB7XG4gICAgICAgIGlmKHJvb209PXRoaXMucmVzU2VsZWN0LlJvb21ObyAmJlxuICAgICAgICAgICAgcGFyc2VJbnQoZGF0ZS5kYXkpPj0gcGFyc2VJbnQodGhpcy5yZXNTZWxlY3QuRnJvbURhdGUpICYmIHBhcnNlSW50KGRhdGUuZGF5KTw9IHBhcnNlSW50KHRoaXMucmVzU2VsZWN0LlRvRGF0ZSkpe1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgQ2hlY2tTdGF0dXNSb29tKHJvb20sZGF0ZSxzdGF0dXMpXG4gICAge1xuICAgICAgICBsZXQgX3RlbXBSZXM9dGhpcy5DaGVja1Jlcyhyb29tLGRhdGUpO1xuICAgICAgICBpZihfdGVtcFJlcyE9bnVsbCApXG4gICAgICAgIHtcbiAgICAgICAgICAgaWYoX3RlbXBSZXMuU3RhdHVzPT1zdGF0dXMpXG4gICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXNTZWxlY3RlZCgpXG4gICAge1xuICAgICAgICB0aGlzLnJlc1NlbGVjdC5zZWxlY3RlZD10cnVlO1xuICAgIH1cblxuICAgIHJlc0l0ZW0ocm9vbSxkYXRlKVxuICAgIHtcbiAgICAgICAgbGV0IF90ZW1wUmVzPXRoaXMuQ2hlY2tSZXMocm9vbSxkYXRlKTtcbiAgICAgICAgaWYoX3RlbXBSZXMhPW51bGwgKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnJlc1NlbGVjdC5JRD1fdGVtcFJlcy5SZXNJRDtcbiAgICAgICAgICAgIHRoaXMucmVzU2VsZWN0LlJvb21Obz1fdGVtcFJlcy5Sb29tTm87XG4gICAgICAgICAgICB0aGlzLnJlc1NlbGVjdC5Gcm9tRGF0ZT1fdGVtcFJlcy5Gcm9tRGF0ZTtcbiAgICAgICAgICAgIHRoaXMucmVzU2VsZWN0LlRvRGF0ZT1fdGVtcFJlcy5Ub0RhdGU7XG4gICAgICAgICAgICB0aGlzLnJlc1NlbGVjdC5zZWxlY3RlZD10cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0UmVzVUkocm9vbSxkYXRlKVxuICAgIHtcbiAgICAgICAgaWYocm9vbT09dGhpcy5yZXNTZWxlY3QuUm9vbU5vICYmIHRoaXMucmVzU2VsZWN0LnNlbGVjdGVkICl7XG4gICAgICAgICAgICBpZihwYXJzZUludChkYXRlLmRheSk9PSBwYXJzZUludCh0aGlzLnJlc1NlbGVjdC5Gcm9tRGF0ZSkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGV0IG5pZ2h0PXBhcnNlSW50KHRoaXMucmVzU2VsZWN0LlRvRGF0ZSktcGFyc2VJbnQodGhpcy5yZXNTZWxlY3QuRnJvbURhdGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuaWdodCsxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IF90ZW1wUmVzPXRoaXMuQ2hlY2tSZXMocm9vbSxkYXRlKTtcbiAgICAgICAgaWYoX3RlbXBSZXMhPW51bGwgKVxuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgbmlnaHQ9cGFyc2VJbnQoX3RlbXBSZXMuVG9EYXRlKS1wYXJzZUludChfdGVtcFJlcy5Gcm9tRGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gbmlnaHQrMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cblxuICAgIGNoZWNrRGF0ZVVJU2VsZWN0KHJvb20sZGF0ZSlcbiAgICB7XG4gICAgICAgIGlmKHJvb209PXRoaXMucmVzU2VsZWN0LlJvb21ObyAmJiB0aGlzLnJlc1NlbGVjdC5zZWxlY3RlZCApe1xuICAgICAgICAgICAgaWYocGFyc2VJbnQoZGF0ZS5kYXkpPiBwYXJzZUludCh0aGlzLnJlc1NlbGVjdC5Gcm9tRGF0ZSkgJiYgcGFyc2VJbnQoZGF0ZS5kYXkpPD0gcGFyc2VJbnQodGhpcy5yZXNTZWxlY3QuVG9EYXRlKSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgX3RlbXBSZXM9dGhpcy5DaGVja1Jlcyhyb29tLGRhdGUpO1xuICAgICAgICBpZihfdGVtcFJlcyE9bnVsbCApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKHBhcnNlSW50KGRhdGUuZGF5KT4gcGFyc2VJbnQoX3RlbXBSZXMuRnJvbURhdGUpICYmIHBhcnNlSW50KGRhdGUuZGF5KTw9IHBhcnNlSW50KF90ZW1wUmVzLlRvRGF0ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cblxuICAgIEdldFJlcyhyb29tLGRhdGUpXG4gICAge1xuICAgICAgICBsZXQgcmVzPXRoaXMuX3JlcztcbiAgICAgICAgbGV0IF90ZW1wUmVzPXRoaXMuQ2hlY2tSZXMocm9vbSxkYXRlKTtcblxuICAgICAgICBpZihfdGVtcFJlcyE9bnVsbClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIF90ZW1wUmVzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYocm9vbT09dGhpcy5yZXNTZWxlY3QuUm9vbU5vICYmIHBhcnNlSW50KGRhdGUuZGF5KT09IHBhcnNlSW50KHRoaXMucmVzU2VsZWN0LkZyb21EYXRlKSAmJiB0aGlzLnJlc1NlbGVjdC5zZWxlY3RlZCl7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNTZWxlY3Q7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIENoZWNrUmVzKHJvb20sZGF0ZSlcbiAgICB7XG4gICAgICAgIGZvciAodmFyIGs9MDtrPCB0aGlzLnJlc0RhdGEubGVuZ3RoO2srKykge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVzRGF0YVtrXS5Sb29tTm8gPT0gcm9vbSAmJiBwYXJzZUludChkYXRlLmRheSk9PSBwYXJzZUludCh0aGlzLnJlc0RhdGFba10uRnJvbURhdGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzRGF0YVtrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
